# DailyTask 远程指令使用指南

## 📱 快速开始

### 什么是远程指令？

远程指令功能允许你通过**微信/企业微信/QQ/TIM/支付宝**的通知，向 DailyTask 应用发送控制命令，实现远程管理打卡任务。

### 基本使用方法

1. 打开微信/企业微信/QQ 等辅助应用
2. 向任何联系人发送指令消息（或使用文件传输助手）
3. DailyTask 会自动接收并执行指令
4. 执行结果会通过邮件通知你

## 📋 指令格式说明

### 三种指令格式

```
格式1（推荐）：指令:<命令> [参数1] [参数2]
格式2（简洁）：#<命令> [参数1] [参数2]
格式3（兼容）：<命令> [参数1] [参数2]（仅限单关键词指令）
```

### 格式对比示例

| 操作 | 格式1（推荐） | 格式2（简洁） | 格式3（兼容） |
|------|---------------|---------------|---------------|
| 启动任务 | `指令:启动` | `#启动` | `启动` |
| 添加任务 | `指令:添加任务 09:00` | `#添加任务 09:00` | ❌ 不支持 |
| 查询任务 | `指令:查询任务` | `#任务列表` | `查询任务` |

💡 **建议**：优先使用"指令:"前缀，避免与普通聊天内容混淆。

## 🎯 完整指令列表

### 1️⃣ 任务控制类

#### 启动/停止任务

```
指令:启动
指令:停止
```

**作用**：立即启动或停止日常打卡任务循环。

**返回邮件**：
- 成功：`任务启动确认` / `任务停止确认`
- 失败：错误原因说明

---

#### 添加任务

```
指令:添加任务 HH:mm
```

**示例**：
```
指令:添加任务 09:00
指令:添加任务 18:30
```

**注意事项**：
- 时间格式必须是 `HH:mm`（24小时制）
- 不能添加重复的时间点
- 小时范围：00-23，分钟范围：00-59

**返回邮件**：
- 成功：显示添加的任务时间和所有任务列表
- 失败：时间格式错误或任务已存在

---

#### 修改任务

```
指令:修改任务 旧时间 新时间
指令:修改任务 旧时间->新时间
```

**示例**：
```
指令:修改任务 09:00 09:15
指令:修改任务 18:00->18:30
#修改任务 12:00 12:30
```

**注意事项**：
- 旧时间必须存在
- 新时间不能与其他任务冲突
- 支持空格或箭头分隔符

**返回邮件**：
- 成功：显示修改前后的时间和所有任务列表
- 失败：任务不存在或新时间冲突

---

#### 删除任务

```
指令:删除任务 HH:mm
```

**示例**：
```
指令:删除任务 09:00
#删除任务 18:30
```

**返回邮件**：
- 成功：显示删除的任务和剩余任务列表
- 失败：任务不存在

---

#### 查询任务

```
指令:查询任务
指令:任务列表
#任务列表
```

**返回邮件**：显示所有已配置的打卡任务，按时间排序。

**示例返回**：
```
当前共有 3 个打卡任务：

1. 09:00
2. 13:00
3. 18:00

提示：发送'指令:添加任务 HH:mm'可添加新任务
```

---

#### 重试打卡

```
指令:重试打卡
#重试打卡
```

**作用**：立即触发一次打卡操作（不等待定时任务）。

**使用场景**：
- 打卡失败需要手动重试
- 临时需要补打卡
- 测试打卡功能

---

### 2️⃣ 系统管理类

#### 开始/暂停循环

```
指令:开始循环
指令:暂停循环
```

**作用**：启用或禁用任务自动启动功能。

**说明**：
- **开始循环**：工作日 7:00-10:00 会自动检测并启动任务
- **暂停循环**：不会自动启动，需手动发送"启动"指令

**返回邮件**：`循环任务状态通知`

---

#### 重启应用

```
指令:重启应用
指令:重启
#重启
```

**作用**：远程重启 DailyTask 应用。

**使用场景**：
- 应用出现异常需要重启
- 配置修改后需要重启生效
- 强制刷新应用状态

**注意**：应用会在 3 秒后自动重启。

---

#### 修改超时时间

```
指令:修改超时 秒数
```

**示例**：
```
指令:修改超时 45
指令:修改超时 60
#修改超时 90
```

**作用**：调整打卡页面停留的超时时长。

**参数范围**：10-300 秒

**默认值**：30 秒

**返回邮件**：确认新的超时时间设置

---

#### 查询配置

```
指令:查询配置
指令:配置信息
#配置信息
```

**返回邮件**：显示所有系统配置信息。

**示例返回**：
```
【系统配置信息】

⏱ 打卡超时时间：30秒
🔄 自动启动任务：已开启
📝 任务名称关键词：打卡
🕐 每日重置时间：0:00
🎲 随机时间：已关闭
📅 周末打卡：已关闭
🎊 节假日打卡：已关闭

📋 任务数量：3个

提示：发送'指令:修改超时 秒数'可修改超时时间
```

---

### 3️⃣ 状态查询类

#### 查询电量

```
指令:电量
#电量
```

**返回邮件**：显示当前手机剩余电量百分比。

---

#### 查询考勤记录

```
指令:考勤记录
#考勤
```

**返回邮件**：显示今天所有的考勤打卡记录。

**示例返回**：
```
当天考勤记录通知

【第1次】考勤打卡成功，时间：2026-02-06 09:02:34
【第2次】考勤打卡成功，时间：2026-02-06 18:01:22
```

---

#### 查询应用状态

```
指令:应用状态
指令:状态
#状态
```

**返回邮件**：显示应用运行状态摘要。

**示例返回**：
```
【应用运行状态】

📱 设备电量：85%
▶️ 任务状态：运行中
📋 任务数量：3个
📝 今日通知：5条
⏰ 当前时间：2026-02-06 14:30:15

提示：发送'指令:查询任务'可查看所有任务
```

---

#### 查询日志

```
指令:日志查询
指令:日志查询 行数
```

**示例**：
```
指令:日志查询        （查询最近10条）
指令:日志查询 20     （查询最近20条）
#日志查询 30
```

**返回邮件**：显示最近N条应用运行日志。

**默认行数**：10 条

---

#### 查询版本信息

```
指令:版本信息
指令:版本
#版本
```

**返回邮件**：显示应用版本号和构建信息。

**示例返回**：
```
【版本信息】

📦 应用名称：DailyTask
🏷 版本号：3.0.4
🔢 构建号：3004
📅 当前日期：2026-02-06 14:30:15

GitHub: https://github.com/xiaohuai3344/DailyTask-master3344
```

---

### 4️⃣ 显示控制类

#### 息屏/亮屏

```
指令:息屏
指令:亮屏
```

**作用**：显示或隐藏伪灭屏遮罩层。

**使用场景**：
- 打卡时需要隐藏屏幕内容
- 手动控制屏幕显示状态

---

#### 延迟息屏

```
指令:延迟息屏 秒数
```

**示例**：
```
指令:延迟息屏 10
#延迟息屏 30
```

**作用**：设定N秒后自动显示息屏遮罩。

**参数范围**：1-60 秒

---

### 5️⃣ 帮助指令

#### 获取帮助

```
指令:帮助
#help
help
```

**返回邮件**：完整的远程指令帮助文档。

---

## 🔒 安全机制

### 1. 指令来源验证

只接受以下应用发送的通知指令：
- ✅ 微信（com.tencent.mm）
- ✅ 企业微信（com.tencent.wework）
- ✅ QQ（com.tencent.mobileqq）
- ✅ TIM（com.tencent.tim）
- ✅ 支付宝（com.eg.android.AlipayGphone）

其他应用的通知会被忽略。

### 2. 指令格式验证

- 严格的参数类型检查
- 参数范围验证
- 防止恶意指令注入

### 3. 频率限制

- 同一类型邮件 60 秒内只发送一次
- 避免指令洪泛攻击

### 4. 操作确认

- 所有指令执行后都会发送邮件确认
- 记录详细的执行日志

---

## 💡 使用技巧

### 1. 推荐使用场景

#### 场景1：忘记添加任务
```
情况：今天临时需要加班，18:30 也要打卡
解决：指令:添加任务 18:30
```

#### 场景2：任务时间调整
```
情况：公司调整上班时间，从 9:00 改为 8:30
解决：指令:修改任务 09:00 08:30
```

#### 场景3：出差不需要打卡
```
情况：本周出差，暂时不需要自动打卡
解决：指令:暂停循环
回来后：指令:开始循环
```

#### 场景4：打卡失败需要重试
```
情况：收到"打卡失败"邮件通知
解决：指令:重试打卡
```

#### 场景5：检查应用状态
```
情况：不确定任务是否在运行
解决：指令:应用状态
```

### 2. 快捷指令组合

#### 每日检查（早上）
```
1. 指令:应用状态      （检查运行状态）
2. 指令:查询任务      （确认今日任务）
3. 指令:电量          （确认电量充足）
```

#### 任务管理（晚上）
```
1. 指令:考勤记录      （查看今日打卡）
2. 指令:日志查询 20   （检查异常日志）
3. 指令:查询配置      （确认配置正常）
```

#### 问题排查（异常时）
```
1. 指令:应用状态      （检查运行状态）
2. 指令:日志查询 30   （查看错误日志）
3. 指令:重启应用      （重启恢复）
4. 指令:重试打卡      （手动重试）
```

### 3. 错误处理

#### 指令格式错误
**症状**：收到"指令格式错误"邮件  
**原因**：参数数量或格式不正确  
**解决**：
1. 发送 `指令:帮助` 查看正确格式
2. 按照返回的示例重新发送

#### 参数范围错误
**症状**：收到"参数超出范围"邮件  
**原因**：参数值不在允许范围内  
**解决**：检查参数范围要求，调整后重发

#### 任务不存在
**症状**：收到"任务不存在"邮件  
**原因**：指定的任务时间不在列表中  
**解决**：
1. 发送 `指令:查询任务` 查看现有任务
2. 使用正确的时间重新发送

---

## 📊 指令执行流程

```
用户发送消息
    ↓
微信/QQ 推送通知
    ↓
DailyTask 接收通知
    ↓
提取指令内容
    ↓
解析指令和参数
    ↓
验证指令格式 ←────→ 格式错误，发送错误邮件
    ↓
检查参数范围 ←────→ 参数错误，发送错误邮件
    ↓
执行指令操作 ←────→ 执行失败，发送错误邮件
    ↓
记录执行日志
    ↓
发送确认邮件 → 用户收到邮件通知
```

---

## ❓ 常见问题

### Q1：为什么指令没有执行？

**可能原因**：
1. 发送的应用不在辅助应用列表中
2. 指令格式不正确（缺少"指令:"前缀或参数错误）
3. DailyTask 应用被系统杀死
4. 通知权限未授予

**解决方法**：
1. 使用微信/QQ等支持的应用发送
2. 使用"指令:"前缀，确保格式正确
3. 检查应用是否在后台运行
4. 确认已授予通知监听权限

---

### Q2：为什么收不到确认邮件？

**可能原因**：
1. 邮件配置不正确
2. 网络连接问题
3. 邮件被垃圾箱拦截

**解决方法**：
1. 检查应用内的邮件配置
2. 确认网络连接正常
3. 查看邮箱垃圾箱

---

### Q3：可以在哪些应用发送指令？

**支持的应用**：
- ✅ 微信
- ✅ 企业微信
- ✅ QQ
- ✅ TIM
- ✅ 支付宝

**发送对象**：
- 任何微信/QQ联系人
- 文件传输助手（推荐）
- 微信/QQ群聊

**注意**：只要这些应用推送了通知，DailyTask 就能接收到指令。

---

### Q4：指令会被其他人看到吗？

**隐私说明**：
- 指令通过通知传递，不依赖网络服务器
- 只有你的设备上的 DailyTask 能接收并执行
- 对方看到的只是普通文本消息
- 建议使用"文件传输助手"发送，更私密

---

### Q5：指令执行需要多久？

**执行时间**：
- 简单查询：即时（<1秒）
- 任务操作：1-3秒
- 重启应用：3-5秒
- 重试打卡：5-15秒（取决于打卡页面加载）

**邮件通知**：通常在指令执行后 3-10 秒内收到。

---

## 🎨 进阶技巧

### 1. 批量操作脚本

虽然不支持一次发送多条指令，但可以快速连发：

```
指令:添加任务 08:30
指令:添加任务 12:00
指令:添加任务 13:30
指令:添加任务 17:30
```

每条指令单独执行，每条都会收到确认邮件。

---

### 2. 定期检查脚本

建议每天检查一次应用状态：

**早上（8:00）**：
```
指令:应用状态
指令:电量
```

**晚上（19:00）**：
```
指令:考勤记录
指令:日志查询
```

---

### 3. 异常监控

如果收到"打卡失败"邮件，立即执行：

```
1. 指令:日志查询 30     （查看错误原因）
2. 指令:重试打卡        （尝试重新打卡）
3. 指令:应用状态        （确认应用正常）
```

---

## 📝 更新日志

### v3.0.4（2026-02-06）

**新增指令**：
- ✨ 添加任务
- ✨ 修改任务
- ✨ 删除任务
- ✨ 查询任务
- ✨ 重启应用
- ✨ 查询配置
- ✨ 修改超时时间
- ✨ 应用状态查询
- ✨ 日志查询
- ✨ 版本信息查询
- ✨ 延迟息屏
- ✨ 帮助指令

**改进**：
- 🔒 增强指令格式验证
- 🔒 增强参数范围检查
- 📧 优化邮件通知格式
- 📝 完善日志记录

---

## 🔗 相关链接

- **GitHub 仓库**：https://github.com/xiaohuai3344/DailyTask-master3344
- **问题反馈**：https://github.com/xiaohuai3344/DailyTask-master3344/issues
- **设计文档**：REMOTE_COMMANDS_DESIGN.md

---

## 📞 技术支持

如有问题或建议，欢迎通过以下方式联系：

- **GitHub Issues**：提交问题和建议
- **邮箱**：290677893@qq.com

---

**文档版本**：v1.0  
**创建日期**：2026-02-06  
**最后更新**：2026-02-06  
**适用版本**：DailyTask v3.0.4+
